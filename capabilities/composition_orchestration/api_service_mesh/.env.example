# APG API Service Mesh - Environment Configuration Template
#
# Copy this file to .env and customize the values for your environment.
# This file contains all configuration options with secure defaults.
#
# Â© 2025 Datacraft. All rights reserved.
# Author: Nyimbi Odero <nyimbi@gmail.com>

# =============================================================================
# Application Configuration
# =============================================================================

# Environment (development, staging, production)
ENVIRONMENT=development

# Application settings
APP_NAME=APG API Service Mesh
APP_VERSION=1.0.0
DEBUG=true
LOG_LEVEL=DEBUG

# Server configuration
HOST=0.0.0.0
PORT=8000
WORKERS=4
RELOAD=true

# =============================================================================
# Security Configuration
# =============================================================================

# Secret keys (CHANGE THESE IN PRODUCTION!)
SECRET_KEY=your-super-secret-key-change-this-in-production
JWT_SECRET_KEY=your-jwt-secret-key-change-this-in-production
ENCRYPTION_KEY=your-encryption-key-32-chars-long

# Session configuration
SESSION_LIFETIME=3600
JWT_EXPIRATION=86400

# CORS settings
CORS_ORIGINS=["http://localhost:3000", "http://localhost:8080", "http://localhost:8000"]
CORS_ALLOW_CREDENTIALS=true

# =============================================================================
# Database Configuration
# =============================================================================

# PostgreSQL database URL
DATABASE_URL=postgresql://asm_user:asm_password@localhost:5432/api_service_mesh_dev

# Database connection pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# Database SSL settings (for production)
DB_SSL_MODE=prefer
DB_SSL_CERT_PATH=
DB_SSL_KEY_PATH=
DB_SSL_CA_PATH=

# =============================================================================
# Cache and Message Queue Configuration
# =============================================================================

# Redis configuration
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=
REDIS_CONNECTION_POOL_SIZE=20
REDIS_MAX_CONNECTIONS=50

# Cache settings
CACHE_TTL=300
CACHE_KEY_PREFIX=asm:

# =============================================================================
# APG Platform Integration
# =============================================================================

# APG Capability Registry
APG_REGISTRY_URL=http://localhost:8001
APG_REGISTRY_TOKEN=

# APG Event Bus
APG_EVENT_BUS_URL=redis://localhost:6379/1
APG_EVENT_BUS_TOPIC_PREFIX=apg:events:

# APG Composition Engine
APG_COMPOSITION_ENGINE_URL=http://localhost:8002
APG_COMPOSITION_ENGINE_TOKEN=

# =============================================================================
# Service Mesh Configuration
# =============================================================================

# Mesh settings
MESH_NAME=apg-development
MESH_NAMESPACE=default
MESH_CLUSTER_ID=dev-cluster-001

# Load balancing
DEFAULT_LB_ALGORITHM=round_robin
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=5
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=60

# Traffic management
DEFAULT_TIMEOUT_MS=30000
DEFAULT_RETRY_ATTEMPTS=3
RATE_LIMITING_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=1000
RATE_LIMIT_BURST_SIZE=100

# =============================================================================
# Monitoring and Observability
# =============================================================================

# Metrics
METRICS_ENABLED=true
METRICS_PORT=9090
PROMETHEUS_ENDPOINT=/metrics

# Distributed tracing
TRACING_ENABLED=true
JAEGER_ENDPOINT=http://localhost:14268/api/traces
JAEGER_SAMPLING_RATE=0.1

# Logging
LOG_FORMAT=json
LOG_FILE_PATH=/app/logs/service-mesh.log
LOG_ROTATION_SIZE=100MB
LOG_RETENTION_DAYS=30

# Health checks
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_ENDPOINT=/api/health

# =============================================================================
# External Services
# =============================================================================

# Email configuration (for alerts)
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_USER=
SMTP_PASSWORD=
SMTP_USE_TLS=false
SMTP_FROM_EMAIL=noreply@datacraft.co.ke

# Webhook notifications
WEBHOOK_URL=
WEBHOOK_SECRET=

# External API keys
EXTERNAL_API_KEY=
EXTERNAL_API_SECRET=

# =============================================================================
# Performance and Scaling
# =============================================================================

# Worker processes
WORKER_CONNECTIONS=1000
WORKER_MAX_REQUESTS=1000
WORKER_MAX_REQUESTS_JITTER=100
WORKER_TIMEOUT=30
WORKER_KEEPALIVE=2
WORKER_GRACEFUL_TIMEOUT=30

# Connection limits
MAX_CONNECTIONS_PER_SERVICE=200
CONNECTION_TIMEOUT=30
READ_TIMEOUT=30
WRITE_TIMEOUT=30

# Memory and resource limits
MAX_MEMORY_USAGE=1G
MAX_CPU_USAGE=500m

# =============================================================================
# Development and Testing
# =============================================================================

# Development mode settings
DEVELOPMENT_MODE=true
RELOAD_ON_CHANGE=true
DEBUG_SQL=false
DEBUG_REDIS=false

# Testing configuration
TESTING=false
TEST_DATABASE_URL=sqlite:///test.db
TEST_REDIS_URL=redis://localhost:6379/15

# =============================================================================
# Backup and Recovery
# =============================================================================

# Backup configuration
BACKUP_ENABLED=false
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30

# S3 backup settings
BACKUP_S3_BUCKET=
BACKUP_S3_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

# =============================================================================
# Feature Flags
# =============================================================================

# Feature toggles
FEATURE_WEBSOCKET_ENABLED=true
FEATURE_METRICS_COLLECTION=true
FEATURE_DISTRIBUTED_TRACING=true
FEATURE_RATE_LIMITING=true
FEATURE_CIRCUIT_BREAKER=true
FEATURE_AUTO_SCALING=false
FEATURE_ML_ROUTING=false

# Beta features
BETA_GRAPHQL_SUPPORT=false
BETA_GRPC_SUPPORT=false
BETA_SERVICE_MESH_FEDERATION=false

# =============================================================================
# Third-party Integrations
# =============================================================================

# Sentry error tracking
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_SAMPLE_RATE=0.1

# DataDog monitoring
DATADOG_API_KEY=
DATADOG_APP_KEY=
DATADOG_SITE=datadoghq.com

# New Relic monitoring
NEW_RELIC_LICENSE_KEY=
NEW_RELIC_APP_NAME=APG-Service-Mesh

# =============================================================================
# Cloud Provider Settings
# =============================================================================

# AWS settings
AWS_REGION=us-east-1
AWS_PROFILE=default

# Azure settings
AZURE_SUBSCRIPTION_ID=
AZURE_RESOURCE_GROUP=
AZURE_LOCATION=eastus

# GCP settings
GOOGLE_CLOUD_PROJECT=
GOOGLE_APPLICATION_CREDENTIALS=

# =============================================================================
# Kubernetes Settings
# =============================================================================

# Kubernetes configuration
KUBERNETES_NAMESPACE=apg-service-mesh
KUBERNETES_SERVICE_ACCOUNT=apg-service-mesh
KUBERNETES_CLUSTER_NAME=apg-cluster

# Pod settings
POD_CPU_REQUEST=250m
POD_CPU_LIMIT=500m
POD_MEMORY_REQUEST=512Mi
POD_MEMORY_LIMIT=1Gi

# =============================================================================
# Custom Settings
# =============================================================================

# Add your custom environment variables here
# CUSTOM_SETTING_1=value1
# CUSTOM_SETTING_2=value2